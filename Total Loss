 def total_variation_loss(x):
 a 
= tf.square(
  x[:, : img_height - 1, : img_width - 1, :] - x[:, 1:, : img_width - 1, :]
 )
 b 
= tf.square(
  x[:, : img_height - 1, : img_width - 1, :] - x[:, : img_height - 1, 1:, :]
 )
 return tf.reduce_sum(tf.pow(a + b, 1.25))
